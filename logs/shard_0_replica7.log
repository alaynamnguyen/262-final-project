REPLICA for shard_0 listening on 127.0.0.1:5008
Replica for shard_0 initialized at 127.0.0.1:5008
  -> Leader: 127.0.0.1:5001
Starting replica heartbeat loop...
  -> Updated replica list: ['127.0.0.1:5002', '127.0.0.1:5003', '127.0.0.1:5008', '127.0.0.1:5006', '127.0.0.1:5010', '127.0.0.1:5009', '127.0.0.1:5005', '127.0.0.1:5011', '127.0.0.1:5004']
  -> Updated replica list: ['127.0.0.1:5002', '127.0.0.1:5003', '127.0.0.1:5008', '127.0.0.1:5006', '127.0.0.1:5010', '127.0.0.1:5009', '127.0.0.1:5005', '127.0.0.1:5011', '127.0.0.1:5004']
Traceback (most recent call last):
  File "/Users/alaynanguyen/Documents/GitHub/262-final-project/server/shard.py", line 285, in <module>
    serve(args.role, args.shard_id, args.port, args.config)
  File "/Users/alaynanguyen/Documents/GitHub/262-final-project/server/shard.py", line 273, in serve
    servicer.on_server_start()
  File "/Users/alaynanguyen/Documents/GitHub/262-final-project/server/shard.py", line 58, in on_server_start
    response = stub.RegisterReplica(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/grpc/_channel.py", line 1181, in __call__
    return _end_unary_response_blocking(state, call, False, None)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/grpc/_channel.py", line 1006, in _end_unary_response_blocking
    raise _InactiveRpcError(state)  # pytype: disable=not-instantiable
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
grpc._channel._InactiveRpcError: <_InactiveRpcError of RPC that terminated with:
	status = StatusCode.UNKNOWN
	details = "Exception calling application: <_InactiveRpcError of RPC that terminated with:
	status = StatusCode.UNAVAILABLE
	details = "failed to connect to all addresses; last error: UNKNOWN: ipv4:127.0.0.1:5006: Failed to connect to remote host: connect: Connection refused (61)"
	debug_error_string = "UNKNOWN:Error received from peer  {grpc_message:"failed to connect to all addresses; last error: UNKNOWN: ipv4:127.0.0.1:5006: Failed to connect to remote host: connect: Connection refused (61)", grpc_status:14, created_time:"2025-04-24T23:25:48.479574-04:00"}"
>"
	debug_error_string = "UNKNOWN:Error received from peer  {grpc_message:"Exception calling application: <_InactiveRpcError of RPC that terminated with:\n\tstatus = StatusCode.UNAVAILABLE\n\tdetails = \"failed to connect to all addresses; last error: UNKNOWN: ipv4:127.0.0.1:5006: Failed to connect to remote host: connect: Connection refused (61)\"\n\tdebug_error_string = \"UNKNOWN:Error received from peer  {grpc_message:\"failed to connect to all addresses; last error: UNKNOWN: ipv4:127.0.0.1:5006: Failed to connect to remote host: connect: Connection refused (61)\", grpc_status:14, created_time:\"2025-04-24T23:25:48.479574-04:00\"}\"\n>", grpc_status:2, created_time:"2025-04-24T23:25:48.502926-04:00"}"
>
Exception in thread Thread-1 (_serve):
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/threading.py", line 1073, in _bootstrap_inner
    self.run()
  File "/opt/anaconda3/lib/python3.12/threading.py", line 1010, in run
    self._target(*self._args, **self._kwargs)
  File "/opt/anaconda3/lib/python3.12/site-packages/grpc/_server.py", line 1334, in _serve
    if not _process_event_and_continue(state, event):
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/grpc/_server.py", line 1288, in _process_event_and_continue
    rpc_state, rpc_future = _handle_call(
                            ^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/grpc/_server.py", line 1127, in _handle_call
    _handle_with_method_handler(
  File "/opt/anaconda3/lib/python3.12/site-packages/grpc/_server.py", line 1064, in _handle_with_method_handler
    return _handle_unary_unary(
           ^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/grpc/_server.py", line 903, in _handle_unary_unary
    return thread_pool.submit(
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/concurrent/futures/thread.py", line 170, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
